---
title: 进程与线程
date: 2021-01-29 22:45:47
categories: 
    - 考研
---

### 进程的概念和特征

#### 进程的定义

- 是进程实体（进程映像）的运行过程，是系统进行资源分配的基本单位

#### 特征

1. 动态性：进程的最基本特征
2. 并发性：多个进程进程实体同时存在于内存中，能在一段时间内同时运行
3. 独立性：系统分配资源的基本单位
4. 异步性：各进程以不可预知的速度向前推进，可能导致运行结果的不确定
5. 结构性：每个进程都配置一个PCB对其进行描述

<!--more-->

---

### 进程的组织与PCB的组织方式

#### 进程的组织

1. 进程控制块（PCB）：进程存在的唯一标志
   - 进程描述信息（进程标识符PID、用户标识符UID）
   - 进程控制管理信息（进程当前状态、进程优先级等）
   - 资源分配清单（代码段指针、堆栈段指针、文件描述符等）
   - 处理机相关信息（通用寄存器、地址寄存器、控制寄存器、标志寄存器，状态字）
2. 程序段：存放要执行的程序代码
3. 数据段：存放程序运行过程中的各种数据，可是原始数据，也可是相关结果

#### PCB的组织方式

1. 链式方式：将同一状态的PCB链接成一个队列
2. 索引方式：将同一状态的PCB组织在一个索引表内，索引表的表项指向相应的PCB

---

### 进程的状态与切换

#### 状态种类

1. 运行态：CPU（获得）、其他资源（获得）
2. 就绪态：CPU（未获得）、其他资源（获得）
3. 阻塞态：CPU（未获得）、其他资源（未获得）
4. 创建态：进程正在被创建，系统为新进程分配资源、创建PCB
5. 结束态：进程正在从消失，系统回收进程资源、撤销PCB

#### 状态转换

1. 就绪态 -> 运行态：进程被调度，获得CPU
2. 运行态 -> 就绪态：时间片用完，或有优先级更高的进程进入，CPU被剥夺
3. 运行态 -> 阻塞态：进程等待某种资源或某事件发生（主动行为）
4. 阻塞态 -> 就绪态：进程需要的资源以分配好或等待的事件已发生（被动行为）
5. 创建态 -> 就绪态：系统完成创建进程的工作
6. 运行态 -> 结束态：进程运行结束或因其他原因退出运行

---

### 进程控制

#### 基本概念

1. 实现进程状态的转换
2. 进程控制通过原语实现
   - 原语用开关中断实现
   - 原语是一种特殊的程序
   - 执行期间不允许中断，是一个不可分割的基本单位

#### 相关原语

1. 创建
2. 终止
3. 阻塞
4. 唤醒
5. 切换

---

### 进程通信

#### 共享存储

1. 特点：互斥的访问共享空间
2. 两种共享方式
   - 低级方式共享：基于数据结构的共享
   - 高级方式共享：基于存储区的共享

#### 消息传递

1. 特点
   - 以格式化的消息（Message）为单位进行数据交换
   - 系统提供**发送消息**与**接收消息**两个原语
2. 两种方式
   - 直接通信方式：消息直接挂到接收方的消息队列中
   - 间接（信箱）通信方式：消息发送到中间实体（信箱）中

#### 管道通信

1. 特点
   - 本质是一个固定大小的缓冲区
   - 一个管道只能实现半双工通信（即某一时刻只能单向传输），实现双向通信需要建立两个管道
   - 管道机制需要3中协调能力，即**互斥**、**同步**、**确认对方的存在**
   - 以字符流形式将数据写入管道，读出时亦然
   - 写满时，不能再写，读空时，不能再读
   - 没写满，不能读，没读空，不能写

---

### 线程的概念与多线程模型

#### 引入线程的目的及线程的特点

1. 目的
   - 减小程序在并发执行时的时空开销，提高系统的并发性能、资源利用率与吞吐量
2. 特点
   - 线程是处理机调度的基本单位，进程是拥有资源的基本单位
   - 线程基本不拥有任何系统资源
   - 同一进程的各线程共享进程拥有的资源
   - 同一进程的不同线程切换不会导致进程切换

#### 线程的实现方式

1. 用户级线程（ULT）：对内核透明，有关线程管理的所有工作都由应用程序完成
2. 内核级线程（KLT）：内核级线程才是处理机调度的基本单位，线程管理的所有工作都由内核完成
3. 组合方式：上述两种方式的结合

#### 多线程模型

1. 多对一模型
   - 优点：线程管理在用户空间进行，故线程管理的开销小、效率高
   - 缺点：一个线程阻塞，整个进程阻塞，并发度低
2. 一对一模型
   - 优点：一个线程阻塞，另一个线程仍能继续执行，并发度高
   - 缺点：线程管理开销大
3. 多对多模型
   - 特点：n个用户级线程映射到m个内核级线程上，且 $m≤n$
   - 优点：集上述两者所长，且克服了两者的缺点
